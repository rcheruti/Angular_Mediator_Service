!function(a){function b(a,b,c){this.name=a,this.element=angular.element(b),this.attrs=[],this.manager=c}function c(){this.element=null}function d(){this.eventModel={},this.listeners={}}var e=angular.module("Menu",["ngTouch"]);e.run(["$injector",function(a){g.element=a.get("$rootElement")}]);var f=b.prototype;f._valCss=function(a){return"menu-"+a+"-"+this.name},f.addClass=function(a){this.manager&&this.manager.element.addClass(this._valCss(a))},f.removeClass=function(a){this.manager&&this.manager.element.removeClass(this._valCss(a))},f.toggleClass=function(a){this.manager&&this.manager.element.toggleClass(this._valCss(a))};var f=c.prototype,g=new c,f=d.prototype;f.register=function(a){if(a instanceof Object||(a=[a]),a instanceof Array)for(var b in a){var c=a[b];this.listeners[c]||(this.listeners[c]={})}else for(var c in a){var d=a[c];this.listeners[c]||(this.listeners[c]={}),this.eventModel[c]=d}return this},f.unregister=function(a){a instanceof Array||(a=[a]);for(var b=0;b<a.length;b++){var c=a[b];this.listeners[c]&&delete this.listeners[c],this.eventModel[c]&&delete this.eventModel[c]}return this},f.on=function(a,b,c){return(b||c)&&this.listeners[a]?(b&&c?b.$on("$destroy",function(){this.off(a,c)}):b&&!c&&(c=b),this.listeners[a].push(c),this):void 0},f.off=function(a,b){for(var c=this.listeners[a],d=0;d<c.length;d++)if(b===c[d]){c.splice(d,1);break}return this},f.event=function(a,b){var c=angular.merge({},this.eventModel[a],b);return c},f.dispatch=function(a,b,c){var d=this.listeners[a];if(c===!0)for(var e=0;e<d.length;e++)d[e](b);else setTimeout(function(){for(var a=0;a<d.length;a++)d[a](b)},c?c:0);return this},e.service("MenuService",[function(){var a={},c=null,e=new d,f={menu:null};e.register({put:f,remove:f});var h={get:function(b){return b?a[b]:a[c]},put:function(c,d){if(!c||!d)return h;var f=a[c]=new b(c,d,g);return e.dispatch("put",e.event("put",{menu:f})),h},remove:function(b){var c=a[b];return delete a[b],e.dispatch("remove",e.event("remove",{menu:c})),h},setDefault:function(a){return c=a,h},on:function(a,b,c){return e.on(a,b,c),h},off:function(a,b){e.off(a,b)}};return h}]),e.directive("menuElement",["MenuService",function(a){return{restrict:"EA",scope:{menuElement:"@",menuDefault:"@"},compile:function(){return{pre:function(b,c,d){var e=d.menuElement,f="true"===(d.menuDefault||"").toLowerCase()?!0:!1;if(!e)throw'You need to define a name for the menu with the "menu-element" attribute. This is required!';a.put(e,c),f&&a.setDefault(e),b.$on("$destroy",function(){a.remove(e)})}}}}}]),e.directive("menuRef",["MenuService",function(a){return{priority:0,restrict:"A",scope:!0,controllerAs:"$ctrl",controller:function(){},compile:function(){return{pre:function(b,c,d,e){e.menuRef=d.menuRef,b.$menu=e.$menu=a.get(d.menuRef)}}}}}]),e.directive("menuToggle",["$swipe","MenuService",function(a,b){return{restrict:"A",priority:10,scope:!1,require:["?^menuRef"],link:function(c,d,e,f){var g=e.menuToggle;if(g){var h=f[0]?f[0].$menu:b.get();a.bind(d,{start:function(a,b){h.toggleClass(g)}})}}}}])}(window);