!function(a){function b(a,b,c){this.name=a,this.element=angular.element(b),this.attrs={},this.manager=c,this._delay=0,this._persistentDelay=!1}function c(){this.element=null,this.$timeout=null}function d(){this.eventModel={},this.listeners={}}function e(a,b){f.directive(a,["$swipe","MenuService",function(c,d){return{require:["?^menuRef","?^menu"],link:function(e,f,g,h){var i=g[a];if(i){var j=h[0]?h[0].$menu:h[1]?h[1].$menu:function(){return d.get()};c.bind(f,{start:function(a,c){j()[b](i)}})}}}}])}var f=angular.module("Menu",["ngTouch"]);f.run(["$rootElement","$timeout",function(a,b){h.element=a,h.$timeout=b}]);var g=b.prototype;g._valCss=function(a){var b=i.lowerCaseClasses?this.name.toLowerCase():this.name;return"menu-"+a+"-"+b},g._check=function(a){return a&&(this.attrs[a]=!0),this.manager?!0:!1},g._delayFunc=function(a){var b=this;b._delay?b.manager.$timeout(function(){b._persistentDelay||(b._delay=0),a.call(b)},b._delay):a.call(b)},g.add=g.addClass=function(a){return this._delayFunc(function(){this.attrs[a]=!0,this.manager.element.addClass(this._valCss(a))}),this},g.remove=g.removeClass=function(a){return this._delayFunc(function(){this.attrs[a]=!1,this.manager.element.removeClass(this._valCss(a))}),this},g.toggle=g.toggleClass=function(a){return this._delayFunc(function(){this.attrs[a]=!this.attrs[a],this.attrs[a]?this.manager.element.addClass(this._valCss(a)):this.manager.element.removeClass(this._valCss(a))}),this},g.removeAll=g.removeClassAll=function(){var a=this.attrs;return this._delayFunc(function(){for(var b in a)this.removeClass(a[b]);this.attrs={}}),this},g.delay=function(a,b){return this._persistentDelay=b,this._delay=a,this},g.has=function(a){return!!this.attrs[a]};var h=new c,g=d.prototype;g.register=function(a){if(a instanceof Object||(a=[a]),a instanceof Array)for(var b in a){var c=a[b];this.listeners[c]||(this.listeners[c]={})}else for(var c in a){var d=a[c];this.listeners[c]||(this.listeners[c]={}),this.eventModel[c]=d}return this},g.unregister=function(a){a instanceof Array||(a=[a]);for(var b=0;b<a.length;b++){var c=a[b];this.listeners[c]&&delete this.listeners[c],this.eventModel[c]&&delete this.eventModel[c]}return this},g.on=function(a,b,c){return(b||c)&&this.listeners[a]?(b&&c?b.$on("$destroy",function(){this.off(a,c)}):b&&!c&&(c=b),this.listeners[a].push(c),this):void 0},g.off=function(a,b){for(var c=this.listeners[a],d=0;d<c.length;d++)if(b===c[d]){c.splice(d,1);break}return this},g.event=function(a,b){var c=angular.merge({},this.eventModel[a],b);return c},g.dispatch=function(a,b,c){var d=this.listeners[a];if(c===!0)for(var e=0;e<d.length;e++)d[e](b);else setTimeout(function(){for(var a=0;a<d.length;a++)d[a](b)},c?c:0);return this};var i;f.provider("MenuService",[function(){i=this,i.lowerCaseClasses=!0,i.$get=[function(){var a={},c=null,e=new d,f={menu:null};e.register({put:f,remove:f});var g={get:function(b){return b?a[b]:a[c]},put:function(c,d){if(!c||!d)return g;var f=a[c]=new b(c,d,h);return e.dispatch("put",e.event("put",{menu:f})),g},remove:function(b){var c=a[b];return c.removeAll(),delete a[b],e.dispatch("remove",e.event("remove",{menu:c})),g},setDefault:function(a){return c=a,g},on:function(a,b,c){return e.on(a,b,c),g},off:function(a,b){e.off(a,b)}};return g}]}]),f.directive("menu",["MenuService",function(a){return{restrict:"EA",scope:!1,controller:function(){},compile:function(){return{pre:function(b,c,d,e){var f=d.menu;if(!f)throw'You need to define a name for the menu with the "menu" attribute. This is required!';var g="true"===(d.menuDefault||"").toLowerCase()?!0:!1;a.put(f,c),g&&a.setDefault(f),e.$menu=function(){return a.get(f)},b.$on("$destroy",function(){a.remove(f)})}}}}}]),f.directive("menuRef",["MenuService",function(a){return{scope:!0,controller:function(){},compile:function(b,c){return{pre:function(b,c,d,e){b.$menu=e.$menu=function(b){return a.get(b||d.menuRef)}}}}}}]),e("menuAdd","add"),e("menuRemove","remove"),e("menuToggle","toggle")}(window);